# SKU列表和明细功能部署测试指南

## 概述

本文档提供了SKU列表和明细功能的部署、测试和使用指南。该功能基于双轨制编码体系设计，实现了完整的SKU管理功能。

## 功能特性

### 1. SKU列表页面

- **多维度筛选**：支持分类、品牌、车型、状态等多条件筛选
- **高级搜索**：支持SKU编码、特征码、产品名称模糊搜索
- **批量操作**：支持批量启用、停用、导出
- **双编码展示**：同时显示SKU编码和特征码
- **库存状态**：显示库存数量和预警状态

### 2. SKU详情页面

- **三栏布局**：基本信息、编码信息、库存信息分栏展示
- **编码解析**：详细展示双轨制编码规则
- **属性详情**：展示变体属性组合
- **合规信息**：HS编码、申报要素等合规信息
- **关联信息**：参考编码、适配车型等关联信息

## 部署步骤

### 1. 后端部署

```bash
# 进入后端目录
cd backend

# 启动Docker服务
docker compose up -d

# 检查服务状态
docker compose ps

# 检查数据库迁移
docker compose exec backend flask db current
```

### 2. 前端部署

```bash
# 进入前端目录
cd frontend

# 安装依赖（如果未安装）
pnpm install

# 启动开发服务器
pnpm dev
```

## API接口测试

### 1. SKU列表API

```
GET /api/v1/products/variants
参数：
- page: 页码（默认1）
- per_page: 每页数量（默认20）
- q: 搜索关键词
- category_id: 分类ID
- brand: 品牌
- model: 车型
- is_active: 状态（true/false）
```

### 2. SKU详情API

```
GET /api/v1/products/variants/{sku}
参数：
- sku: SKU编码
```

### 3. 测试脚本

运行提供的测试脚本验证API功能：

```bash
python test_sku_api.py
```

## 前端访问

### 1. 访问地址

- 开发环境：http://localhost:3000
- SKU列表：http://localhost:3000/product/sku
- SKU详情：http://localhost:3000/product/sku/detail/{sku}

### 2. 功能验证清单

#### SKU列表页面

- [ ] 页面正常加载
- [ ] 数据表格显示正常
- [ ] 分页功能正常
- [ ] 搜索功能正常
- [ ] 高级筛选正常
- [ ] 批量选择正常
- [ ] 批量操作按钮正常
- [ ] 点击SKU跳转详情页

#### SKU详情页面

- [ ] 页面正常加载
- [ ] 三栏布局显示正常
- [ ] 基本信息完整
- [ ] 编码信息解析正确
- [ ] 库存信息显示
- [ ] 标签页切换正常
- [ ] 返回列表功能正常
- [ ] 编辑跳转功能正常

## 数据验证

### 1. 双轨制编码验证

确保SKU编码符合双轨制编码规则：

- **SKU编码**：9位数字 + 字母后缀（如 `101120501DWD`）
- **特征码**：业务可读码（如 `HL-CHE-SIL-07-13-D-WB`）

### 2. 数据完整性验证

- 每个SKU都有对应的SPU
- 属性信息完整
- 状态字段正确
- 时间戳字段完整

## 性能测试

### 1. 数据加载性能

- 列表页加载时间 < 2秒
- 详情页加载时间 < 1秒
- 筛选查询时间 < 1秒

### 2. 并发测试

- 支持多用户同时访问
- 批量操作不阻塞界面

## 常见问题排查

### 1. 页面无法加载

- 检查后端服务是否运行：`docker compose ps`
- 检查前端服务是否运行：`pnpm dev`
- 检查API接口是否可达

### 2. 数据不显示

- 检查数据库连接
- 检查数据迁移状态
- 检查API返回数据格式

### 3. 筛选功能异常

- 检查筛选参数格式
- 检查后端筛选逻辑
- 检查前端参数传递

### 4. 编码解析错误

- 检查SKU编码格式
- 检查编码解析逻辑
- 检查数据库存储格式

## 后续优化建议

### 1. 功能增强

- [ ] 库存系统集成
- [ ] 导出功能完善
- [ ] 权限控制细化
- [ ] 操作日志记录

### 2. 性能优化

- [ ] 数据缓存
- [ ] 查询优化
- [ ] 前端懒加载
- [ ] 图片优化

### 3. 用户体验

- [ ] 移动端适配
- [ ] 操作引导
- [ ] 错误提示优化
- [ ] 加载状态优化

## 技术支持

如遇问题，请参考：

1. 技术框架文档：`开发设计文档/技术框架.md`
2. 编码实施方案：`开发设计文档/L2.0_产品编码双轨制实施方案.md`
3. API文档：Swagger UI (http://localhost:5000/docs)

## 版本历史

| 版本 | 日期       | 说明                  |
| ---- | ---------- | --------------------- |
| v1.0 | 2024-12-09 | 初始版本，基础SKU功能 |
| v1.1 | 待定       | 库存集成、导出功能    |
| v1.2 | 待定       | 权限控制、操作日志    |

---

**注意**：本功能基于双轨制编码体系设计，请确保所有SKU数据符合编码规范。如有编码相关问题，请参考产品编码双轨制实施方案文档。
