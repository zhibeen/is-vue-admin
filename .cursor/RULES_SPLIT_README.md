# Cursor 规则拆分说明

## 拆分背景

原有的 `.cursorrules` 文件和 `.cursor/rules/project.mdc` 包含了大量内容（600+ 行），导致：
1. **职责混杂**: 前后端规范、文档规范、Git 规范混在一起
2. **查找困难**: AI 需要解析整个文件才能找到相关规范
3. **维护不便**: 更新某个领域的规范会影响其他领域

## 拆分方案

将规范拆分为 **5个独立文件**：

### 文件结构

```
.cursor/rules/
├── project.mdc         # 总览文件 (alwaysApply: true)
├── frontend.mdc        # 前端开发规范
├── backend.mdc         # 后端开发规范
├── documentation.mdc   # 文档与日志记录规范
└── git.mdc            # Git 工作流与提交规范
```

### 1. project.mdc (总览文件)
- **标记**: `alwaysApply: true` - 始终应用
- **内容**: 
  - 核心原则（不过度文档化、代码质量、Git 安全）
  - 规则索引（指向其他4个规则文件）
  - 项目架构速览
  - 快速参考（常用代码片段）
  - AI 工作指南
- **行数**: ~200 行

### 2. frontend.mdc (前端规范)
- **适用场景**: Vue 3、VXE Table、Ant Design Vue 开发
- **核心内容**:
  - VXE Table v4.17+ 最新语法（强制）
  - Ant Design Vue 组件导入规范
  - Tailwind CSS 样式规范
  - 深色模式适配要求
  - requestClient API 调用方式
  - 权限控制（v-auth 指令）
- **行数**: ~350 行

### 3. backend.mdc (后端规范)
- **适用场景**: Python/APIFlask 后端开发
- **核心内容**:
  - 分层架构（Route → Service → Model）
  - API 返回值规范（BASE_RESPONSE_SCHEMA）
  - SQLAlchemy 2.0 Mapped Class 写法
  - N+1 查询防范（selectinload/joinedload）
  - Alembic 数据迁移规范
  - Docker 命令执行方式
  - 认证与权限控制
  - 自动化测试
- **行数**: ~400 行

### 4. documentation.mdc (文档规范)
- **适用场景**: 决定是否创建文档、编写技术文档
- **核心原则**: 不要过度文档化
- **核心内容**:
  - 何时创建/不创建文档的判断标准
  - 推荐做法（代码注释 > 内联说明 > 独立文档）
  - 文档类型和格式规范
  - 代码注释规范
  - API 文档编写规范（OpenAPI）
  - 日志记录规范（结构化日志）
- **行数**: ~350 行

### 5. git.mdc (Git 规范)
- **适用场景**: Git 分支管理、代码提交
- **核心原则**: AI 不主动提交、不强制推送
- **核心内容**:
  - 分支管理策略（feature/fix/hotfix）
  - Conventional Commits 提交信息规范
  - AI 提交行为规范（可以/不可以做的事）
  - 提交粒度和时机建议
  - 冲突解决策略
  - .gitignore 规范
- **行数**: ~500 行

## 拆分优势

### 1. 职责清晰
- 前端开发只需关注 `frontend.mdc`
- 后端开发只需关注 `backend.mdc`
- Git 操作只需关注 `git.mdc`

### 2. 易于维护
- 更新前端规范不影响后端
- 添加新的 Git 规范不需要修改其他文件
- 每个文件独立维护，降低冲突风险

### 3. AI 效率提升
- AI 可以根据上下文选择性加载规则
- 减少不相关规范的干扰
- 提高规范匹配准确性

### 4. 可扩展性
- 未来可以轻松添加新的规则文件（如 `testing.mdc`, `deployment.mdc`）
- 支持按模块、按业务领域继续细分

## 使用方式

### Cursor 自动加载
Cursor 会自动加载 `.cursor/rules/` 目录下的所有 `.mdc` 文件。

### 开发者手动查阅
按需查看对应的规则文件：
- 前端开发: 查看 `frontend.mdc`
- 后端开发: 查看 `backend.mdc`
- 写文档: 查看 `documentation.mdc`
- 提交代码: 查看 `git.mdc`

### AI 行为
- AI 会始终遵守 `project.mdc` 中的核心原则
- 根据当前任务自动参考对应的详细规范
- 在不确定时，会明确说明参考了哪个规则文件

## 原有文件处理

### .cursorrules (项目根目录)
**保留** - 更新为索引文件，指向新的规则目录
- 列出所有规则文件及其用途
- 提供快速参考
- 说明拆分原因和使用方式

### .cursor/rules/project.mdc (旧版完整规范)
**更新** - 改为总览文件
- 设置 `alwaysApply: true`
- 保留核心原则和快速参考
- 指向详细规范文件

## 规范版本

- **版本**: v2.0
- **拆分日期**: 2025-01-20
- **拆分原因**: 原单一规则文件过于庞大，职责混杂
- **总行数**: 约 2000 行（拆分为 5 个文件）

## 后续维护建议

1. **保持同步**: 当 `技术框架.md` 更新时，同步更新对应的规则文件
2. **定期审查**: 每月检查规则是否与实际项目一致
3. **收集反馈**: 记录 AI 未能正确遵守的规范，及时补充
4. **持续优化**: 根据使用情况调整规则文件的粒度和内容

## 验证清单

- [x] 创建 `frontend.mdc` - 前端开发规范
- [x] 创建 `backend.mdc` - 后端开发规范
- [x] 创建 `documentation.mdc` - 文档记录规范
- [x] 创建 `git.mdc` - Git 工作流规范
- [x] 更新 `project.mdc` - 改为总览文件
- [x] 更新 `.cursorrules` - 改为索引文件
- [x] 创建本说明文档

## 测试建议

拆分完成后，建议测试以下场景：

1. **前端开发**: 让 AI 创建一个 Vue 组件，检查是否正确使用 VXE Table 新版语法和 Ant Design 组件导入
2. **后端开发**: 让 AI 创建一个 API 接口，检查是否遵循分层架构和返回值规范
3. **文档创建**: 修复一个小 Bug，检查 AI 是否会过度创建文档
4. **Git 提交**: 修改代码后，检查 AI 是否会主动提交，以及提交信息是否符合规范

---

**创建日期**: 2025-01-20  
**创建者**: AI 助手  
**审核者**: 待审核

