# 双线业务流程总览

## 🎯 系统架构概述

本系统采用**双线并行**的业务流程设计，以**发货单**为统一数据起点，分别处理内贸业务和外贸报关业务，通过数据匹配实现业务整合。

## 🏗️ 系统架构图

```
                ┌─────────────────┐
                │    发货单       │
                │ (统一数据起点)  │
                └────────┬────────┘
                         │
        ┌────────────────┼────────────────┐
        │                                │
        ▼                                ▼
┌───────────────┐              ┌───────────────┐
│  业务线       │              │  报关线       │
│ (内贸流程)    │              │ (外贸流程)    │
│               │              │               │
│ 合同管理      │              │ 报关申报      │
│ 付款跟踪      │              │ 退税管理      │
│ 开票管理      │              │               │
└────────┬──────┘              └────────┬──────┘
         │                              │
         └─────────────┬────────────────┘
                       │
                       ▼
             ┌──────────────────┐
             │ 发票-报关单匹配  │
             │ (数据交汇点)     │
             └──────────────────┘
```

## 📊 数据流向说明

### 业务线数据流（内贸流程）
```
发货单（采购数据）
    ↓
合同管理（生成采购合同）
    ↓  
付款跟踪（记录付款信息）
    ↓
开票管理（开具增值税发票）
    ↓
国内增值税链条完成
```

### 报关线数据流（外贸流程）  
```
发货单（出口货物）
    ↓
报关申报（生成报关单）
    ↓
退税管理（出口退税）
    ↓
出口退税链条完成
```

### 数据交汇逻辑
```
发票（业务线产出） ↔ 报关单（报关线产出）
    ↓
建立匹配关系 → 支持出口退税
```

## 🔄 业务流程特点

### 1. 双线并行处理
- **业务线**：专注于国内采购销售流程
- **报关线**：专注于出口报关退税流程
- **相互独立**：两条线可以并行处理
- **数据关联**：通过匹配建立关联关系

### 2. 统一数据起点
- **发货单**：所有业务的共同起点
- **数据一致性**：确保两边数据来源统一
- **追溯能力**：从任一点可追溯完整流程

### 3. 灵活的业务场景支持
- **纯内贸**：只走业务线，不开报关
- **纯外贸**：只走报关线，不开发票
- **内外贸结合**：两条线都走，完成退税

## 📋 核心业务模块

### 业务线模块
- **合同管理**：智能合同生成、合同状态跟踪
- **付款跟踪**：付款记录、付款计划、状态管理
- **开票管理**：开票申请、发票开具、状态更新

### 报关线模块
- **报关申报**：报关单生成、商品编码管理
- **退税管理**：退税资格验证、退税进度跟踪

### 数据交汇模块
- **智能匹配**：发票与报关单自动匹配
- **状态关联**：业务状态与报关状态关联展示

## 🎯 关键业务规则

### 数据一致性规则
- 发货单数据作为唯一数据源头
- 业务数据可调整，报关数据申报后锁定
- 匹配关系建立后数据关联展示

### 状态管理规则
- 业务状态可更新，报关状态只读展示
- 状态变更触发相关业务逻辑
- 异常状态预警和处理

### 权限控制规则
- 业务操作员：合同、付款、开票管理
- 财务审核员：审核、审批、验证
- 系统管理员：配置、监控、维护

## 🔧 技术架构要点

### 数据架构
- 统一数据模型设计
- 数据版本管理支持
- 历史数据追溯能力
- 数据一致性保障

### 系统架构
- 模块化设计，支持独立部署
- 微服务架构，便于扩展
- API接口标准化
- 配置化管理

### 性能优化
- 批量操作支持
- 数据缓存机制
- 异步处理大文件
- 分页加载数据

## 📈 预期业务价值

### 效率提升
- **合同生成**：从小时级降到分钟级
- **发票处理**：自动化率提升80%
- **数据查询**：从手工查找变为一键查询

### 质量改善  
- **数据准确性**：减少手工错误95%
- **流程规范性**：标准化业务流程
- **审计追溯**：完整操作日志

### 成本节约
- **人力成本**：减少重复性工作
- **时间成本**：加速业务处理速度
- **机会成本**：提前发现业务风险

---

**文档版本**：v1.0  
**创建日期**：2025-11-19  
**维护者**：AI Assistant
